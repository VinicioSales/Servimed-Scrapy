# Pytest Configuration
[pytest]
# Diretórios de teste
testpaths = tests

# Padrões de arquivos de teste
python_files = test_*.py *_test.py
python_classes = Test*
python_functions = test_*

# Opções de execução
addopts = 
    -v
    --tb=short
    --strict-markers
    --disable-warnings
    --color=yes
    -ra
    --maxfail=10

# Markers customizados
markers =
    unit: Testes unitários rápidos
    integration: Testes de integração
    slow: Testes lentos que podem ser pulados com -m "not slow"
    network: Testes que requerem conexão de rede
    redis: Testes que requerem Redis rodando
    celery: Testes que requerem Celery configurado
    scrapy: Testes específicos do Scrapy

# Diretórios e arquivos a ignorar
norecursedirs = 
    *.egg
    .eggs
    dist
    build
    .tox
    .git
    __pycache__
    .pytest_cache
    node_modules
    venv
    .venv

# Timeout para testes (em segundos)
timeout = 300

# Configurações de log
log_cli = true
log_cli_level = INFO
log_cli_format = %(asctime)s [%(levelname)8s] %(name)s: %(message)s
log_cli_date_format = %Y-%m-%d %H:%M:%S

# Configurações do ambiente de teste
env =
    TESTING = true
    REDIS_URL = redis://localhost:6379/15
    CELERY_ALWAYS_EAGER = true
    CELERY_EAGER_PROPAGATES_EXCEPTIONS = true

# Filtros de warnings
filterwarnings =
    ignore::UserWarning
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning
    ignore:.*scrapy.*:UserWarning
    ignore:.*celery.*:UserWarning
